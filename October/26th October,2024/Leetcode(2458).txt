hard tree question
easy to code but hard to optimize